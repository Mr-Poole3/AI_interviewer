<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>AI智能面试官 - 专业语音面试系统</title>
    <link rel="stylesheet" href="/static/style.css?v=2024010103">
    <link rel="stylesheet" href="/static/evaluation-styles.css?v=2024010103">
    <link rel="stylesheet" href="/static/tutorial-guide.css?v=2024010103">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>💼</text></svg>">
    <!-- Lottie动画库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script
      src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs"
      type="module"
    ></script>
    <!-- 字体图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- 主应用容器 -->
    <div class="app-container">
        <!-- 顶部导航栏 -->
        <nav class="modern-navbar" id="navbar">
            <div class="nav-container">
                <!-- 品牌logo -->
                <div class="nav-brand">
                    <div class="brand-info">
                        <h1 class="brand-title">天汇AI</h1>
                        <span class="brand-subtitle">智能语音面试系统</span>
                    </div>
                </div>
                
                <!-- 导航菜单 -->
                <div class="nav-menu">
                    <button class="nav-item active" id="navInterview" data-page="interview">
                        <div class="nav-item-icon">
                            <i class="fas fa-microphone"></i>
                        </div>
                        <div class="nav-item-content">
                            <span class="nav-item-title">语音面试</span>
                            <span class="nav-item-desc">开始面试</span>
                        </div>
                    </button>
                    
                    <button class="nav-item" id="navHistory" data-page="history">
                        <div class="nav-item-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="nav-item-content">
                            <span class="nav-item-title">面试记录</span>
                            <span class="nav-item-desc">历史记录</span>
                        </div>
                    </button>
                    
                    <button class="nav-item" id="navResume" data-page="resume">
                        <div class="nav-item-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="nav-item-content">
                            <span class="nav-item-title">简历管理</span>
                            <span class="nav-item-desc">上传简历</span>
                        </div>
                    </button>
                </div>
                
                <!-- 连接状态 -->
                <div class="nav-status">
                    <div class="connection-indicator" id="connectionStatus">
                        <div class="status-dot"></div>
                        <div class="status-info">
                        <span class="status-text">连接中...</span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- 页面路由容器 -->
        <div class="page-router" id="pageRouter">
            
            <!-- 面试页面 -->
            <div class="page interview-page" id="interviewPage">
                <!-- 面试欢迎界面 -->
                <div class="interview-welcome">
                    <div class="welcome-hero">
                        <div class="hero-background">
                            <div class="hero-pattern"></div>
                        </div>
                        <div class="hero-content">
                            <h1 class="hero-title">欢迎使用天汇AI智能面试系统</h1>
                            <p class="hero-subtitle">基于人工智能的专业语音面试系统，为您提供个性化的面试体验</p>
                            
                            <div class="hero-features">
                                <div class="feature-item">
                                    <div class="feature-icon">
                                        <i class="fas fa-comments"></i>
                                    </div>
                                    <div class="feature-content">
                                        <h3>实时语音对话</h3>
                                        <p>自然流畅的语音交互体验</p>
                                    </div>
                                </div>
                                
                                <div class="feature-item">
                                    <div class="feature-icon">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <div class="feature-content">
                                        <h3>AI智能分析</h3>
                                        <p>基于简历的个性化面试问题</p>
                                    </div>
                                </div>
                                
                                <div class="feature-item">
                                    <div class="feature-icon">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="feature-content">
                                        <h3>专业评估</h3>
                                        <p>全面的技能能力评估报告</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 开始面试按钮 -->
                            <div class="hero-actions">
                                <button class="hero-start-btn" id="heroStartButton" title="开始语音面试">
                                    <div class="btn-icon">
                                        <i class="fas fa-microphone"></i>
                                    </div>
                                    <span class="btn-text">开始面试</span>
                                    <div class="btn-glow"></div>
                                </button>
                                <p class="hero-hint">点击开始您的AI语音面试体验</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 面试聊天界面 -->
                <div class="interview-chat" id="interviewChat">
                    <!-- 聊天容器 -->
                    <div class="chat-container">
                        <!-- 聊天头部 -->
                        <div class="chat-header">
                            <div class="interviewer-info">
                                <div class="interviewer-avatar">
                                    <i class="fas fa-user-tie"></i>
                                </div>
                                <div class="interviewer-details">
                                    <h3>天汇AI面试官</h3>
                                    <p class="interviewer-status">在线 - 准备就绪</p>
                                </div>
                            </div>
                            <div class="chat-actions">
                                <!-- 已删除清空对话和全屏模式按钮 -->
                            </div>
                        </div>

                        <!-- 消息区域 -->
                        <div class="chat-messages" id="chatMessages">
                            <!-- 初始引导消息 -->
                            <div class="system-message">
                                <div class="system-icon">
                                    <i class="fas fa-info-circle"></i>
                                </div>
                                <div class="system-content">
                                    <h4>面试准备提示</h4>
                                    <ul>
                                        <li>确保您的网络连接稳定</li>
                                        <li>选择安静的环境进行面试</li>
                                        <li>建议上传简历以获得个性化问题</li>
                                        <li>放松心情，真实表达自己</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- 语音控制区域 -->
                        <div class="voice-control-panel">
                            <div class="control-container">
                                <!-- 语音状态显示 -->
                                <div class="voice-status">
                                    <div class="status-indicator">
                                        <div class="pulse-ring"></div>
                                        <div class="pulse-ring delay-1"></div>
                                        <div class="pulse-ring delay-2"></div>
                                    </div>
                                    <div class="status-text">
                                        <span class="status-title" id="voiceHint">点击开始语音面试</span>
                                        <span class="status-desc">确保麦克风权限已开启</span>
                                    </div>
                                </div>
                                
                                <!-- 主控制按钮 -->
                                <div class="main-controls">
                                    <button class="voice-start-btn" id="voiceCallButton" title="开始语音面试">
                                        <div class="btn-icon">
                                            <i class="fas fa-microphone"></i>
                                        </div>
                                        <span class="btn-text">开始面试</span>
                                    </button>
                                </div>
                                
                                <!-- 快捷操作 -->
                                <div class="quick-actions">
                                    <button class="quick-btn" title="上传简历">
                                        <i class="fas fa-upload"></i>
                                    </button>
                                    <button class="quick-btn" title="查看历史">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="quick-btn" id="preparationSettingsButton" title="面试设置">
                                        <i class="fas fa-cog"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- 面试准备设置面板 -->
                            <div class="preparation-settings-panel" id="preparationSettingsPanel" style="display: none;">
                                <div class="settings-header">
                                    <h3><i class="fas fa-cog"></i> 面试设置</h3>
                                    <button class="close-settings" id="closePreparationSettings">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>

                                <div class="settings-content">
                                    <!-- 语音检测设置 -->
                                    <div class="settings-section">
                                        <h4><i class="fas fa-microphone-alt"></i> 语音检测</h4>

                                        <div class="setting-group">
                                            <label for="prepVoiceSensitivity">语音敏感度</label>
                                            <div class="slider-container">
                                                <input type="range" id="prepVoiceSensitivity" min="0.1" max="1.0" step="0.1" value="0.5">
                                                <span class="slider-value" id="prepVoiceSensitivityValue">0.5</span>
                                            </div>
                                            <p class="setting-description">调整语音检测的敏感度，数值越高越不敏感</p>
                                        </div>

                                        <div class="setting-group">
                                            <label for="prepSilenceDuration">静音时长</label>
                                            <div class="slider-container">
                                                <input type="range" id="prepSilenceDuration" min="500" max="3000" step="250" value="1500">
                                                <span class="slider-value" id="prepSilenceDurationValue">1500ms</span>
                                            </div>
                                            <p class="setting-description">停止说话后多久AI开始回复</p>
                                        </div>

                                        <div class="setting-group">
                                            <label for="prepPrefixPadding">语音缓冲</label>
                                            <div class="slider-container">
                                                <input type="range" id="prepPrefixPadding" min="0" max="1000" step="100" value="300">
                                                <span class="slider-value" id="prepPrefixPaddingValue">300ms</span>
                                            </div>
                                            <p class="setting-description">在检测到语音前包含的音频时长</p>
                                        </div>
                                    </div>

                                    <!-- 音频设置 -->
                                    <div class="settings-section">
                                        <h4><i class="fas fa-volume-up"></i> 音频设置</h4>

                                        <div class="setting-group">
                                            <label for="prepAudioVolume">音量</label>
                                            <div class="slider-container">
                                                <input type="range" id="prepAudioVolume" min="0.1" max="1.0" step="0.1" value="1.0">
                                                <span class="slider-value" id="prepAudioVolumeValue">100%</span>
                                            </div>
                                            <p class="setting-description">调整AI语音回复的音量大小</p>
                                        </div>

                                        <div class="setting-group">
                                            <label for="prepPlaybackSpeed">播放速度</label>
                                            <div class="slider-container">
                                                <input type="range" id="prepPlaybackSpeed" min="0.5" max="2.0" step="0.1" value="1.0">
                                                <span class="slider-value" id="prepPlaybackSpeedValue">1.0x</span>
                                            </div>
                                            <p class="setting-description">调整AI语音回复的播放速度</p>
                                        </div>
                                    </div>

                                    <!-- 设置操作 -->
                                    <div class="settings-actions">
                                        <button class="btn-secondary" id="resetPreparationSettings">重置默认</button>
                                        <button class="btn-primary" id="applyPreparationSettings">应用设置</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 历史记录页面 -->
            <div class="page history-page" id="historyPage" style="display: none;">
                <div class="page-container">
                    <!-- 页面头部 -->
                    <div class="page-header">
                        <div class="header-content">
                            <div class="header-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <div class="header-info">
                                <h1>面试记录</h1>
                                <p>查看和管理您的历史面试记录</p>
                            </div>
                        </div>
                        <div class="header-actions">
                            <button class="btn-secondary" id="clearHistoryBtn">
                                <i class="fas fa-trash"></i>
                                清空记录
                            </button>
                        </div>
                    </div>
                    
                    <!-- 筛选控制 -->
                    <div class="filter-panel">
                        <div class="filter-group">
                            <label class="filter-label">
                                <i class="fas fa-sort"></i>
                                排序方式
                            </label>
                            <select class="filter-select" id="sortBy">
                                <option value="date-desc">最新优先</option>
                                <option value="date-asc">最早优先</option>
                                <option value="duration-desc">时长最长</option>
                                </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">
                                <i class="fas fa-search"></i>
                                搜索记录
                            </label>
                            <input type="text" class="filter-input" id="searchHistoryInput" placeholder="按标题或摘要搜索...">
                        </div>
                        <div class="filter-stats">
                            <div class="stat-item">
                                <span class="stat-number">0</span>
                                <span class="stat-label">总面试数</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">0h 0m</span>
                                <span class="stat-label">总时长</span>
                            </div>
                            </div>
                        </div>

                    <!-- 记录列表 -->
                    <div class="history-container">
                        <div class="history-list" id="historyList">
                            <!-- 空状态 -->
                            <div class="empty-state" id="emptyHistory">
                                <div class="empty-illustration">
                                    <i class="fas fa-clipboard-list"></i>
                                </div>
                                <h3>暂无面试记录</h3>
                                <p>开始您的第一次AI语音面试，记录将自动保存在这里</p>
                                <button class="btn-primary" id="startFirstInterviewBtn">
                                    <i class="fas fa-play"></i>
                                    开始首次面试
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 简历设置页面 -->
            <div class="page resume-page" id="resumePage" style="display: none;">
                <div class="page-container">
                    <!-- 页面头部 -->
                    <div class="page-header">
                        <div class="header-content">
                            <div class="header-icon">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <div class="header-info">
                                <h1>简历管理</h1>
                                <p>上传简历以获得个性化的面试体验</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 统一的简历管理界面 -->
                    <div class="resume-manager">
                        <!-- 合并后的简历区域 -->
                        <div class="resume-section">
                            <div class="section-header">
                                 <div class="section-title">
                                    <h2>
                                        <i class="fas fa-file-check"></i>
                                        <span id="resumeSectionTitle">简历管理</span>
                                    </h2>
                                </div>
                                <div class="section-actions" id="sectionActions">
                                    <!-- 动态操作按钮将在这里显示 -->
                            </div>
                        </div>

                        <!-- 简历上传区域 -->
                        <div class="resume-section">
                            <div class="section-header">
                                <h2>
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    上传简历
                                </h2>
                            </div>

                            <!-- 岗位意向选择 -->
                            <div class="job-preference-section">
                                <div class="preference-header">
                                    <h3>
                                        <i class="fas fa-bullseye"></i>
                                        岗位意向
                                    </h3>
                                    <p>请选择您的意向岗位类别，以便AI面试官为您提供更精准的面试体验</p>
                                </div>

                                <div class="preference-selectors">
                                    <div class="selector-group">
                                        <label for="jobCategory">
                                            <i class="fas fa-layer-group"></i>
                                            行业大类
                                        </label>
                                        <select id="jobCategory" class="preference-select">
                                            <option value="">请选择行业大类</option>
                                            <option value="computer">计算机/互联网</option>
                                            <option value="finance">经济/金融</option>
                                            <option value="engineering">工程技术</option>
                                            <option value="marketing">市场营销</option>
                                            <option value="design">设计创意</option>
                                            <option value="education">教育培训</option>
                                            <option value="healthcare">医疗健康</option>
                                            <option value="consulting">咨询顾问</option>
                                            <option value="manufacturing">制造业</option>
                                            <option value="media">媒体传播</option>
                                            <option value="legal">法律</option>
                                            <option value="hr">人力资源</option>
                                            <option value="sales">销售</option>
                                            <option value="logistics">物流供应链</option>
                                            <option value="other">其他</option>
                                        </select>
                                    </div>

                                    <div class="selector-group">
                                        <label for="jobPosition">
                                            <i class="fas fa-user-tie"></i>
                                            具体岗位
                                        </label>
                                        <select id="jobPosition" class="preference-select" disabled>
                                            <option value="">请先选择行业大类</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="preference-tips">
                                    <i class="fas fa-info-circle"></i>
                                    <span>选择岗位意向后，AI面试官将根据该岗位的要求进行针对性面试</span>
                                </div>
                            </div>

                            <div class="upload-zone" id="resumeFileUploadArea">
                                <div class="upload-content">
                                    <div class="upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <div class="upload-text">
                                        <h3>拖拽简历文件到此处</h3>
                                        <p>或点击选择文件上传</p>
                                        <div class="upload-formats">
                                            <span class="format-tag">PDF</span>
                                            <span class="format-tag">DOC</span>
                                            <span class="format-tag">DOCX</span>
                                        </div>
                                    </div>
                                    <input type="file" id="resumeFileInput" class="file-input" accept=".pdf,.doc,.docx" />
                                </div>
                            </div>
                            <div class="resume-content" id="resumeContent">
                                <!-- 动态内容将在这里显示 -->
                            </div>
                        </div>
                        
                        <!-- 上传提示 -->
                        <div class="upload-tips" id="uploadTips">
                            <h4>
                                <i class="fas fa-lightbulb"></i>
                                上传建议
                            </h4>
                            <ul>
                                <li>文件大小不超过10MB</li>
                                <li>确保简历内容清晰完整</li>
                                <li>支持中英文简历</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 加载动画覆盖层 -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-animation">
                <div class="loading-ring"></div>
                <div class="loading-ring"></div>
                <div class="loading-ring"></div>
            </div>
            <h3 class="loading-title">正在连接天汇AI面试官</h3>
            <p class="loading-subtitle">请稍候，正在初始化语音服务...</p>
        </div>
    </div>

    <!-- 语音通话全屏界面 -->
    <div class="voice-call-fullscreen" id="voiceCallFullscreen" style="display: none;">
        <!-- 背景 -->
        <div class="voice-call-backdrop" id="voiceCallBackdrop"></div>
        
        <!-- 语音界面内容 -->
        <div class="voice-interface">
            <!-- 顶部状态栏 -->
            <div class="voice-call-status-bar">
                <div class="status-bar-left">
                    <div class="connection-quality" id="connectionQuality">
                        <div class="signal-bars">
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                        </div>
                        <span class="quality-text">连接良好</span>
                    </div>
                </div>
                
                <div class="status-bar-center">
                    <div class="call-status" id="callStatus">
                        <div class="status-indicator-dot"></div>
                        <span class="status-text">通话进行中</span>
                    </div>
                </div>
                
                <div class="status-bar-right">
                    <div class="interview-progress" id="interviewProgress">
                        <span class="progress-label">对话轮次</span>
                        <span class="progress-count" id="progressCount">0</span>
                    </div>
                </div>
            </div>
            
            <!-- 面试官头像区域 -->
            <div class="interviewer-section">
                <!-- 圆形头像背景已删除 -->
                <h2 class="interviewer-name">天汇AI面试官</h2>
                <p class="interviewer-title">专业技术面试官</p>
                
                <!-- 当前状态显示 -->
                <div class="current-status" id="currentStatus">
                    <div class="status-icon" style="display: none;">
                        <!-- 麦克风图标已删除 -->
                    </div>
                    <p class="status-message" id="statusMessage">正在聆听您的声音...</p>
                </div>
            </div>
            
            <!-- Lottie动画容器 -->
            <div class="voice-animation-container" id="voiceAnimationContainer">
                <dotlottie-player
                    id="voiceLottiePlayer"
                    src="https://lottie.host/8778427b-2d8c-477b-99c7-18fd22c3de7b/32za1oZNzw.lottie"
                    background="transparent"
                    speed="1"
                    style="width: 200px; height: 200px"
                    loop
                    autoplay
                ></dotlottie-player>
            </div>
            
            <!-- 语音级别显示 -->
            <div class="voice-level-display" id="voiceLevelDisplay">
                <div class="level-meter">
                    <div class="level-bar-container">
                        <div class="level-bar" data-level="1"></div>
                        <div class="level-bar" data-level="2"></div>
                        <div class="level-bar" data-level="3"></div>
                        <div class="level-bar" data-level="4"></div>
                        <div class="level-bar" data-level="5"></div>
                        <div class="level-bar" data-level="6"></div>
                        <div class="level-bar" data-level="7"></div>
                        <div class="level-bar" data-level="8"></div>
                    </div>
                    <div class="level-label">
                        <span class="level-text" id="levelText">静音</span>
                        <span class="level-tip">说话音量</span>
                    </div>
                </div>
            </div>
            
            <!-- 状态显示 -->
            <div class="voice-status-section">
                <div class="status-display">
                <div class="voice-timer" id="voiceTimer">00:00</div>
                    <div class="timer-label">通话时长</div>
                </div>
            </div>
            
            <!-- 实时提示区域 -->
            <div class="voice-tips" id="voiceTips">
                <div class="tip-item active">
                    <i class="fas fa-lightbulb"></i>
                    <span>保持自然对话，AI会根据您的回答进行深入提问</span>
                </div>
            </div>
            
            <!-- 控制按钮 -->
            <div class="voice-controls">
                <!-- 静音按钮 -->
                <button class="voice-control-btn mute-btn" id="muteButton" title="静音/取消静音">
                    <i class="fas fa-microphone mic-icon"></i>
                    <i class="fas fa-microphone-slash mic-off-icon" style="display: none;"></i>
                </button>
                
                <!-- VAD设置按钮 -->
                <button class="voice-control-btn settings-btn" id="vadSettingsButton" title="语音检测设置">
                    <i class="fas fa-cog"></i>
                </button>
                
                <!-- 结束通话按钮 -->
                <button class="voice-control-btn end-btn" id="endCallButton" title="结束通话">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
            </div>
            
            <!-- VAD设置面板 -->
            <div class="vad-settings-panel" id="vadSettingsPanel" style="display: none;">
                <div class="settings-header">
                    <h3>语音检测设置</h3>
                    <button class="close-settings" id="closeVadSettings">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="settings-content">
                    <div class="setting-group">
                    <label for="vadThreshold">检测敏感度</label>
                        <div class="slider-container">
                        <input type="range" id="vadThreshold" min="0.1" max="1.0" step="0.1" value="0.5">
                        <span class="slider-value" id="vadThresholdValue">0.5</span>
                    </div>
                    <p class="setting-description">调整语音检测的敏感度，值越小越敏感</p>
                    </div>
                    
                    <div class="setting-group">
                    <label for="vadSilenceDuration">静音检测时长</label>
                        <div class="slider-container">
                        <input type="range" id="vadSilenceDuration" min="500" max="3000" step="100" value="1000">
                        <span class="slider-value" id="vadSilenceDurationValue">1000ms</span>
                    </div>
                    <p class="setting-description">检测到静音后等待多长时间停止录音</p>
                    </div>
                    
                    <div class="setting-group">
                    <label for="vadPrefixPadding">前缀填充时长</label>
                        <div class="slider-container">
                        <input type="range" id="vadPrefixPadding" min="100" max="1000" step="50" value="300">
                        <span class="slider-value" id="vadPrefixPaddingValue">300ms</span>
                    </div>
                    <p class="setting-description">在检测到语音前包含的音频时长</p>
                    </div>
                    
                    <div class="settings-actions">
                        <button class="btn-secondary" id="resetVadSettings">重置默认</button>
                        <button class="btn-primary" id="applyVadSettings">应用设置</button>
                </div>
            </div>
        </div>
    </div>
    <div id="evaluationModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <div id="modalEvaluationContent" class="evaluation-display">
                <div class="loading-spinner" style="display:none;">加载中...</div>
                <div class="evaluation-actual-content"></div>
            </div>
        </div>
    </div>

    <!-- 对话详情模态框 -->
    <div id="conversationModal" class="modal" style="display: none;">
        <div class="modal-content conversation-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-comments"></i>
                    面试对话记录
                </h3>
                <div class="modal-actions">
                    <button class="btn-secondary btn-sm" id="exportConversationBtn" title="导出对话记录">
                        <i class="fas fa-download"></i>
                        导出
                    </button>
                    <button class="close-button" id="closeConversationModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="modal-body">
                <div class="conversation-info">
                    <div class="info-item">
                        <span class="info-label">面试时间：</span>
                        <span class="info-value" id="conversationDate">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面试时长：</span>
                        <span class="info-value" id="conversationDuration">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">对话轮次：</span>
                        <span class="info-value" id="conversationCount">--</span>
                    </div>
                </div>
                
                <div class="conversation-container">
                    <div class="conversation-messages" id="conversationMessages">
                        <!-- 对话消息将在这里动态生成 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 面试保存确认对话框 -->
    <div id="saveInterviewModal" class="modal" style="display: none;">
        <div class="modal-content save-interview-modal">
            <div class="save-interview-header">
                <div class="save-interview-icon">
                    <i class="fas fa-save"></i>
                </div>
                <h3>保存面试记录</h3>
                <p>您的面试对话已结束，是否需要保存本次面试记录？</p>
            </div>
            
            <div class="save-interview-info">
                <div class="interview-stats">
                    <div class="stat-item">
                        <i class="fas fa-clock"></i>
                        <span class="stat-label">面试时长</span>
                        <span class="stat-value" id="interviewDurationDisplay">--</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-comments"></i>
                        <span class="stat-label">对话轮次</span>
                        <span class="stat-value" id="interviewMessageCountDisplay">--</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-file-alt"></i>
                        <span class="stat-label">简历状态</span>
                        <span class="stat-value" id="resumeStatusDisplay">--</span>
                    </div>
                </div>
                
                <div class="save-benefits">
                    <h4><i class="fas fa-star"></i> 保存后您可以：</h4>
                    <ul>
                        <li><i class="fas fa-chart-bar"></i> 获得详细的面试评分和分析</li>
                        <li><i class="fas fa-history"></i> 在历史记录中随时查看回顾</li>
                        <li><i class="fas fa-file-pdf"></i> 导出面试报告为PDF文档</li>
                        <li><i class="fas fa-lightbulb"></i> 收到个性化的改进建议</li>
                    </ul>
                </div>
            </div>
            
            <div class="save-interview-actions">
                <button class="btn-secondary" id="discardInterviewBtn">
                    <i class="fas fa-trash-alt"></i>
                    不保存
                </button>
                <button class="btn-primary" id="saveInterviewBtn">
                    <i class="fas fa-save"></i>
                    保存记录
                </button>
            </div>
        </div>
    </div>
    <!-- JavaScript 文件 -->
    <!-- 直接加载PDF库 - 使用不同的CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- 备用CDN -->
    <script>
        // 检查jsPDF是否加载成功，如果没有则尝试备用CDN
        setTimeout(() => {
            if (typeof window.jsPDF === 'undefined') {
                console.log('主CDN失败，加载备用jsPDF...');
                const script = document.createElement('script');
                script.src = 'https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js';
                script.onload = () => {
                    console.log('备用jsPDF加载成功');
                    if (window.pdfExporter) {
                        window.pdfExporter.isLibrariesLoaded = window.pdfExporter.testLibraries();
                    }
                };
                script.onerror = () => {
                    console.error('备用jsPDF也加载失败');
                };
                document.head.appendChild(script);
            }
        }, 1000);
    </script>
    <!-- PDF导出模块 -->
    <script src="/static/pdf-export.js"></script>
    <!-- 新手引导系统 -->
    <!-- 简历详情抽屉Modal -->
    <div class="resume-drawer-modal" id="resumeDrawerModal" style="display: none;">
        <div class="drawer-backdrop" onclick="resumeManager.hideFullResume()"></div>
        <div class="drawer-container">
            <div class="drawer-header">
                <div class="drawer-title">
                    <i class="fas fa-file-alt"></i>
                    <span>简历详情</span>
                </div>
                <button class="drawer-close" onclick="resumeManager.hideFullResume()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="drawer-body">
                <div class="resume-full-content" id="resumeFullContent">
                    <!-- 完整简历内容将在这里显示 -->
                </div>
            </div>
            <div class="drawer-footer">
                <button class="btn-secondary" onclick="resumeManager.hideFullResume()">
                    <i class="fas fa-times"></i>
                    关闭
                </button>
                <button class="btn-primary" onclick="resumeManager.copyResumeContent()">
                    <i class="fas fa-copy"></i>
                    复制内容
                </button>
            </div>
        </div>
    </div>

    <!-- Markdown解析库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <script src="/static/tutorial-guide.js?v=2024010103"></script>
    <!-- 智能提示系统 -->
    <script src="/static/smart-tips.js?v=2024010103"></script></script>
    <script src="/static/voice-call.js?v=2024010103"></script>
    <script src="/static/app.js?v=2024010103"></script>
</body>
</html> 
